# Enumeration & Exploitation in Python
#NCL
---
## Analyze Vulnerabilities in Python
#WebTools 

To try and find vulnerabilities in python lets look at the code below and attempt to find suitable passwords.
>![Python Code Snippet](python1.png)

If we look at the password section of the code we know a few things.
![Python Code Password Snippet](python2.png)

`-The password length = 10.
`-The second character is ASCII 83. ASCII 83 = "S". This can be found by using a Unicode Table.
`-The total ASCII value of the entire password = 1000. 

Now we can take the total password value of 1000 and subtract 83 to get the remaining value of 917. 
**We now know that the rest of our password must equal 917**.

To find a password that will work you need to remember that the second character must an "S" and then any combination of characters that fill up the 9 remaining spaces that equal 917.

A few examples of passwords that will work are:
`-mSeeeeeeee
`-eSffffffff

**Further Reading and Tools**
- [Python Crash Course](https://www.youtube.com/watch?v=I2wURDqiXdM)
- [Unicode Table](https://unicode-table.com)
- [Python 3 Documentation](https://docs.python.org/3/)

---
## Decompile and Analyze Python Code
#KaliTools 
#WebTools

To view the code of a .pyc file you need to decompile the file back to Python code. You can do this with a tool called uncompyle6. *Note that uncopyle2 only runs on Python 2.6 and later.* 

When you run uncompyle6 on the file you should get back this Python code:
![Decompiled Python Code Snippet](python3.png)

If we look at this code we can see a few things:
- The given password is being compared against `vals`
- The password length is equal to the length of `vals`
- The given password is being shifted by 7 before it is compared against `vals`

To solve for the password we need to shift the encoded password by 7.
We can do this by using an online tool found [here](http://rumkin.com/tools/cipher/caesar.php). To use this tool N = 26 - "Shift Number". So you would shift by 19.

>If done correctly
>`tfzbwlyzljylawhzzdvyk` -> mysupersecretpassword

**Further Reading and Tools**
- [Uncompyle6](https://github.com/rocky/python-uncompyle6)
- [Uncompyle2](https://github.com/Mysterie/uncompyle2)
- [Caesar Shift](http://rumkin.com/tools/cipher/caesar.php)
- [Python 3 Documentation](https://docs.python.org/3/)
- [Python Crash Course](https://www.youtube.com/watch?v=I2wURDqiXdM)

