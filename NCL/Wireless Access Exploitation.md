# Wireless Access Exploitation
#NCL
---
## Cracking WEP encryption from PCAP
#KaliTools 

To crack WEP encryption from a PCAP file you can use a tool called aircrack-ng. When you run aircrack-ng on the captured packet you will get a summary of the file. This lists the number if IVs found and the WEP key.

The WEP key size can be found by counting the number of bits in the key text (5 bytes * 8 bits per byte = 40 bits) and comparing that to the WEP key sizes (64 bit WEP contains a 40-bit key and a 24-bit initialization vector which forms the 64-bit RC4 key).

>**To view an IV (initialization vector) view the capture in wireshark and filter by WLAN WEP Ivs by using `wlan.wep.iv`. The IVs are under the WEP parameters section.**

>Aircrack-ng command example
>`aircrack-ng file.pcap`

>Screenshot of aircrack-ng summary
>![Aircrack-ng Summary Screenshot](aircrack.jpg)

**Further Reading**
- [Aircrack-ng](https://www.aircrack-ng.org/index.html)
- [Aircrack-ng Documentation](https://www.aircrack-ng.org/doku.php?id=aircrack-ng)

---
## Decrypting Traffic from WEP using Wireshark
#KaliTools 

To decrypt the traffic you will need the WEP key. If you do not have the WEP key reference the section above about using Aircrack-ng.

Once you have the key, open the PCAP in wireshark. Navigate to preferences by going to `Edit>Preferences>Protocols>IEEE 802.11` and enabling decryption and add the key.

>Screenshot of Wireshark preferences
>![Wireshark Preferences](wiresharkprefs.png)
>![Wireshark Keys](wiresharkkeys.png)

**Further Reading**
- [Wireshark Decrypting WEP](https://wiki.wireshark.org/HowToDecrypt802.11)

---
## Cracking WPA with Aircrack-ng and a Wordlist
#KaliTools 

To crack WPA encryption to a captured packet you can use aircrack-ng. Aircrack-ng allows you to run against a wordlist. There are different wordlists you can use. Default wordlists that come with Kali can be found at `/usr/share/wordlists/`. 

You will need the access point's mac address and ESSID. To find these you can open the file in wireshark and check for beacon frames or broadcasts.

Now you can run against the wordlist using aircrack.
>Aircrack-ng Wordlist Command
>`aircrack-ng -w wordlist.txt -b C0:4A:00:80:76:E4 file.cap`
>-w stands for wordlist
>-b stands for the target network based on the access point's MAC address

Now that you have the WPA you can decrypt the captured packet file. To do this open the PCAP in wireshark. Navigate to preferences by going to `Edit>Preferences>Protocols>IEEE 802.11` and enabling decryption and add the key.

>Screenshot of Wireshark preferences
>![Wireshark Preferences](wiresharkprefs.png)
>![Wireshark Keys](wiresharkkeys.png)

**Further Reading**
- [Wireshark Decrypting WEP](https://wiki.wireshark.org/HowToDecrypt802.11)
- [Aircrack-ng Documentation](https://www.aircrack-ng.org/doku.php?id=aircrack-ng)
